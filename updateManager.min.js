/**
 *
 * @licstart  The following is the entire license notice for the 
 *  JavaScript code in this page.
 *
 * Copyright (C) 2018  Arthur Malulley B. de O.
 *
 *
 * The JavaScript code in this page is free software: you can
 * redistribute it and/or modify it under the terms of the GNU
 * General Public License (GNU GPL) as published by the Free Software
 * Foundation, either version 3 of the License, or (at your option)
 * any later version.  The code is distributed WITHOUT ANY WARRANTY;
 * without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.
 *
 * As additional permission under GNU GPL version 3 section 7, you
 * may distribute non-source (e.g., minimized or compacted) forms of
 * that code without the copy of the GNU GPL normally required by
 * section 4, provided you include this license notice and a URL
 * through which recipients can access the Corresponding Source.
 *
 * @licend  The above is the entire license notice
 * for the JavaScript code in this page.
 *
 */
console.log("###########################################"),console.log("# PSO2 Affixing Assistant's Build Manager #"),console.log("###########################################"),console.log("Starting the build process..."),console.log("Setting up the build environment...");var e=require("fs");const{exec:t}=require("child_process"),n=require("readline").createInterface({input:process.stdin,output:process.stdout});let i=null,o=null,s=require("./js/affixData"),l=require("./js/lang");const a=require("./js/affixDataParser");var d="./intermediate";!function(e){let i=["node-fetch","cheerio","uglify-es","uglifycss"];var o=0,s=t=>{t?++o<i.length?l(i[o],s):e(!0):e(!1)};function l(e,i){try{require.resolve(e),i(!0)}catch(o){console.log("Linking package: "+e),t("npm link "+e,(o,s,l)=>{if(o)n.question("Could not create local link to package "+e,function(e){i(!1)});else try{require.resolve(e),i(!0)}catch(o){n.question(`The Build Manager requires the NodeJS package '${e}' to operate.\nTo install it, run the following command on a NodeJS command prompt:\n    npm install ${e}\nPress 'Y' to install it now on the application folder, 'G' to install it now globally, or any key to quit...`,function(n){"Y"===n||"y"===n?(console.log("Running 'npm install "+e+"'..."),t("npm install "+e,(t,n,o)=>{if(t)return console.log("NodeJS package '"+e+"' could not be installed."),console.log(t),void i(!1);console.log(n),console.log("NodeJS packed installed successfully."),i(!0)})):"G"===n||"g"===n?(console.log("Running 'npm install "+e+" -g'..."),t("npm install "+e+" -g",(t,n,o)=>{if(t)return console.log("NodeJS package '"+e+"' could not be installed."),console.log(t),void i(!1);console.log(n),console.log("NodeJS packed installed successfully."),i(!0)})):i(!1)})}})}}l(i[0],s)}(t=>{if(!t)return console.log("Some required NodeJS packages are missing, please install them and try again."),void process.exit();i=require("node-fetch"),o=require("cheerio");var a=()=>{if(console.log("Validating files..."),function(e,t){if(void 0===e||null===e||"object"!=typeof e)return console.log("Assistant's Affix Database must be an object"),!1;if(void 0===e.optionList||null===e.optionList||"object"!=typeof e.optionList)return console.log("Assistant's Affix Database must contain an object property called 'optionList'"),!1;if(void 0===e.optionList.support||null===e.optionList.support||"object"!=typeof e.optionList.support||void 0===e.optionList.support.length)return console.log("Assistant's Affix Database must contain an list property called 'support' inside 'optionList'"),!1;if(e.optionList.support.filter(e=>void 0===e.id||null===e.id||"string"!=typeof e.id).length>0)return console.log("Assistant's Affix Database must contain a string property called 'id' for every item inside 'optionList.support'"),console.log(e.optionList.support.filter(e=>void 0===e.id||null===e.id||"string"!=typeof e.id)),!1;if(e.optionList.support.filter(e=>void 0===e.name||null===e.name||"string"!=typeof e.name).length>0)return console.log("Assistant's Affix Database must contain a string property called 'name' for every item inside 'optionList.support'"),console.log(e.optionList.support.filter(e=>void 0===e.name||null===e.name||"string"!=typeof e.name)),!1;if(e.optionList.support.filter(e=>void 0===e.value||null===e.value||"string"!=typeof e.value).length>0)return console.log("Assistant's Affix Database must contain a string property called 'value' for every item inside 'optionList.support'"),console.log(e.optionList.support.filter(e=>void 0===e.value||null===e.value||"string"!=typeof e.value)),!1;if(e.optionList.support.filter(e=>void 0===e.fn||null===e.fn||"function"!=typeof e.fn).length>0)return console.log("Assistant's Affix Database must contain a function property called 'fn' for every item inside 'optionList.support'"),console.log(e.optionList.support.filter(e=>void 0===e.fn||null===e.fn||"function"!=typeof e.fn)),!1;if(void 0===e.optionList.additional||null===e.optionList.additional||"object"!=typeof e.optionList.additional||void 0===e.optionList.additional.length)return console.log("Assistant's Affix Database must contain an list property called 'additional' inside 'optionList'"),!1;if(e.optionList.additional.filter(e=>void 0===e.id||null===e.id||"string"!=typeof e.id).length>0)return console.log("Assistant's Affix Database must contain a string property called 'id' for every item inside 'optionList.additional'"),console.log(e.optionList.additional.filter(e=>void 0===e.id||null===e.id||"string"!=typeof e.id)),!1;if(e.optionList.additional.filter(e=>"Nothing"!==e.id&&(void 0===e.name||null===e.name||"string"!=typeof e.name)).length>0)return console.log("Assistant's Affix Database must contain a string property called 'name' for every item inside 'optionList.additional'"),console.log(e.optionList.additional.filter(e=>"Nothing"!==e.id&&(void 0===e.name||null===e.name||"string"!=typeof e.name))),!1;if(e.optionList.additional.filter(e=>void 0===e.value||null===e.value||"string"!=typeof e.value).length>0)return console.log("Assistant's Affix Database must contain a string property called 'value' for every item inside 'optionList.additional'"),console.log(e.optionList.additional.filter(e=>void 0===e.value||null===e.value||"string"!=typeof e.value)),!1;if(e.optionList.additional.filter(e=>"Nothing"!==e.id&&(void 0===e.extend||null===e.extend||"number"!=typeof e.extend||e.extend<0||e.extend>100||!Number.isInteger(e.extend))).length>0)return console.log("Assistant's Affix Database must contain a integer property ranging from 0 to 100 called 'extend' for every item inside 'optionList.additional'"),console.log(e.optionList.additional.filter(e=>"Nothing"!==e.id&&(void 0===e.extend||null===e.extend||"number"!=typeof e.extend||e.extend<0||e.extend>100||!Number.isInteger(e.extend)))),!1;if(e.optionList.additional.filter(e=>"Nothing"!==e.id&&(void 0===e.effect||null===e.effect||"string"!=typeof e.effect)).length>0)return console.log("Assistant's Affix Database must contain a string property called 'effect' for every item inside 'optionList.additional'"),console.log(e.optionList.additional.filter(e=>"Nothing"!==e.id&&(void 0===e.effect||null===e.effect||"string"!=typeof e.effect))),!1;if(void 0===e.optionList.potential||null===e.optionList.potential||"object"!=typeof e.optionList.potential||void 0===e.optionList.potential.length)return console.log("Assistant's Affix Database must contain an list property called 'potential' inside 'optionList'"),!1;if(e.optionList.potential.filter(e=>void 0===e.id||null===e.id||"string"!=typeof e.id).length>0)return console.log("Assistant's Affix Database must contain a string property called 'id' for every item inside 'optionList.potential'"),console.log(e.optionList.potential.filter(e=>void 0===e.id||null===e.id||"string"!=typeof e.id)),!1;if(e.optionList.potential.filter(e=>void 0===e.name||null===e.name||"string"!=typeof e.name).length>0)return console.log("Assistant's Affix Database must contain a string property called 'name' for every item inside 'optionList.potential'"),console.log(e.optionList.potential.filter(e=>void 0===e.name||null===e.name||"string"!=typeof e.name)),!1;if(e.optionList.potential.filter(e=>void 0===e.value||null===e.value||"string"!=typeof e.value).length>0)return console.log("Assistant's Affix Database must contain a string property called 'value' for every item inside 'optionList.potential'"),console.log(e.optionList.potential.filter(e=>void 0===e.value||null===e.value||"string"!=typeof e.value)),!1;if(e.optionList.potential.filter(e=>void 0===e.fn||null===e.fn||"function"!=typeof e.fn).length>0)return console.log("Assistant's Affix Database must contain a function property called 'fn' for every item inside 'optionList.potential'"),console.log(e.optionList.potential.filter(e=>void 0===e.fn||null===e.fn||"function"!=typeof e.fn)),!1;if(void 0===e.optionList.boostWeek||null===e.optionList.boostWeek||"object"!=typeof e.optionList.boostWeek||void 0===e.optionList.boostWeek.length)return console.log("Assistant's Affix Database must contain an list property called 'boostWeek' inside 'optionList'"),!1;if(e.optionList.boostWeek.filter(e=>void 0===e||null===e||"number"!=typeof e||e<0||e>100||!Number.isInteger(e)).length>0)return console.log("Assistant's Affix Database must only contain integer numbers ranging from 0 to 100 inside 'optionList.boostWeek'"),console.log(e.optionList.boostWeek.filter(e=>void 0===e||null===e||"number"!=typeof e||e<0||e>100||!Number.isInteger(e))),!1;if(void 0===e.excludePattern||null===e.excludePattern||"object"!=typeof e.excludePattern)return console.log("Assistant's Affix Database must contain an object property called 'excludePattern'"),!1;if(void 0===e.excludePattern.addition||null===e.excludePattern.addition||"object"!=typeof e.excludePattern.addition)return console.log("Assistant's Affix Database must contain an object property called 'addition' inside 'excludePattern'"),!1;if(e.excludePattern.addition.filter(e=>void 0===e||null===e||!("string"==typeof e||"object"==typeof e&&void 0!==e.length&&0==e.filter(e=>void 0===e||null===e||"string"!=typeof e).length)).length>0)return console.log("Assistant's Affix Database must only contain strings and/or list of strings inside 'excludePattern.addition'"),console.log(e.excludePattern.addition.filter(e=>void 0===e||null===e||!("string"==typeof e||"object"==typeof e&&void 0!==e.length&&0==e.filter(e=>void 0===e||null===e||"string"!=typeof e).length))),!1;if(void 0===e.excludePattern.select||null===e.excludePattern.select||"object"!=typeof e.excludePattern.select)return console.log("Assistant's Affix Database must contain an object property called 'select' inside 'excludePattern'"),!1;if(e.excludePattern.select.filter(e=>void 0===e||null===e||!("string"==typeof e||"object"==typeof e&&0==e.filter(e=>void 0===e||null===e||"string"!=typeof e).length)).length>0)return console.log("Assistant's Affix Database must only contain strings and/or list of strings inside 'excludePattern.select'"),console.log(e.excludePattern.select.filter(e=>void 0===e||null===e||!("string"==typeof e||"object"==typeof e&&0==e.filter(e=>void 0===e||null===e||"string"!=typeof e).length))),!1;if(void 0===e.extendAbility||null===e.extendAbility||"object"!=typeof e.extendAbility||void 0===e.extendAbility.length)return console.log("Assistant's Affix Database must contain a list property called 'extendAbility'"),!1;if(e.extendAbility.filter(e=>void 0===e||null===e||"object"!=typeof e).length>0)return console.log("Assistant's Affix Database must only contain objects inside 'extendAbility'"),console.log(e.extendAbility.filter(e=>void 0===e||null===e||"object"!=typeof e)),!1;if(e.extendAbility.filter(e=>void 0===e.base||null===e.base||"object"!=typeof e.base||void 0===e.base.length||e.base.filter(e=>void 0===e||null===e||"string"!=typeof e).length>0).length>0)return console.log("Assistant's Affix Database must contain a list of strings called 'base' for every item inside 'extendAbility'"),console.log(e.extendAbility.filter(e=>void 0===e.base||null===e.base||"object"!=typeof e.base||void 0===e.base.length||e.base.filter(e=>void 0===e||null===e||"string"!=typeof e))),!1;if(e.extendAbility.filter(e=>void 0===e.ref||null===e.ref||!("string"==typeof e.ref||"object"==typeof e.ref&&void 0!==e.ref.length&&0==e.ref.filter(e=>void 0===e||null===e||"string"!=typeof e).length)).length>0)return console.log("Assistant's Affix Database must contain a list of strings called 'base' or a string property called 'base' for every item inside 'extendAbility'"),console.log(e.extendAbility.filter(e=>void 0===e.ref||null===e.ref||!("string"==typeof e.ref||"object"==typeof e.ref&&void 0!==e.ref.length&&0==e.ref.filter(e=>void 0===e||null===e||"string"!=typeof e).length))),!1;if(e.extendAbility.filter(e=>void 0===e.success||null===e.success||"number"!=typeof e.success||e.success<0||e.success>100||!Number.isInteger(e.success)).length>0)return console.log("Assistant's Affix Database must contain an integer property ranging from 0 to 100 called 'success' for every item inside 'extendAbility'"),console.log(e.extendAbility.filter(e=>void 0===e.success||null===e.success||"number"!=typeof e.success||e.success<0||e.success>100||!Number.isInteger(e.success))),!1;if(void 0===e.extraSlot||null===e.extraSlot||"object"!=typeof e.extraSlot||void 0===e.extraSlot.length)return console.log("Assistant's Affix Database must contain a list property called 'extraSlot'"),!1;if(e.extraSlot.filter(e=>void 0===e||null===e||"object"!=typeof e).length>0)return console.log("Assistant's Affix Database must only contain objects inside 'extraSlot'"),console.log(e.extraSlot.filter(e=>void 0===e||null===e||"object"!=typeof e)),!1;if(e.extraSlot.filter(e=>void 0===e.true||null===e.true||"number"!=typeof e.true||e.true<0||e.true>100||!Number.isInteger(e.true)).length>0)return console.log("Assistant's Affix Database must contain an integer property called 'true' ranging from 0 to 100 for every item inside 'extraSlot'"),console.log(e.extraSlot.filter(e=>void 0===e.true||null===e.true||"number"!=typeof e.true||e.true<0||e.true>100||!Number.isInteger(e.true))),!1;if(e.extraSlot.filter(e=>void 0===e.false||null===e.false||"number"!=typeof e.false||e.false<0||e.false>100||!Number.isInteger(e.false)).length>0)return console.log("Assistant's Affix Database must contain an integer property called 'false' ranging from 0 to 100 for every item inside 'extraSlot'"),console.log(e.extraSlot.filter(e=>void 0===e.false||null===e.false||"number"!=typeof e.false||e.false<0||e.false>100||!Number.isInteger(e.false))),!1;if(void 0===e.boostPoint||null===e.boostPoint||"object"!=typeof e.boostPoint)return console.log("Assistant's Affix Database must contain an object property called 'boostPoint'"),!1;if(void 0===e.sameBonusBoost||null===e.sameBonusBoost||"object"!=typeof e.sameBonusBoost||void 0===e.sameBonusBoost.length)return console.log("Assistant's Affix Database must contain a list property called 'sameBonusBoost'"),!1;if(e.sameBonusBoost.filter(e=>void 0===e||null===e||"number"!=typeof e).length>0)return console.log("Assistant's Affix Database must only contain float numbers inside 'sameBonusBoost'"),console.log(e.sameBonusBoost.filter(e=>void 0===e||null===e||"number"!=typeof e)),!1;if(void 0===e.pairingExceptions||null===e.pairingExceptions||"object"!=typeof e.pairingExceptions)return console.log("Assistant's Affix Database must contain an object property called 'pairingExceptions'"),!1;if(void 0===e.pairingExceptions.strict||null===e.pairingExceptions.strict||"object"!=typeof e.pairingExceptions.strict)return console.log("Assistant's Affix Database must contain an object property called 'strict' inside 'pairingExceptions'"),!1;if(e.pairingExceptions.strict.filter(e=>void 0===e||null===e||"object"!=typeof e||void 0===e.length||e.filter(e=>void 0===e||null===e||"string"!=typeof e).length>0).length>0)return console.log("Assistant's Affix Database must only contain lists of strings inside 'pairingExceptions.strict'"),console.log(e.pairingExceptions.strict.filter(e=>void 0===e||"object"!=typeof e||null===e||void 0===e.length||e.filter(e=>void 0===e||null===e||"string"!=typeof e).length>0)),!1;if(void 0===e.pairingExceptions.lenient||null===e.pairingExceptions.lenient||"object"!=typeof e.pairingExceptions.lenient)return console.log("Assistant's Affix Database must contain an object property called 'lenient' inside 'pairingExceptions'"),!1;if(e.pairingExceptions.lenient.filter(e=>void 0===e||null===e||"object"!=typeof e||void 0===e.length||e.filter(e=>void 0===e||null===e||"string"!=typeof e).length>0).length>0)return console.log("Assistant's Affix Database must only contain lists of strings inside 'pairingExceptions.lenient'"),console.log(e.pairingExceptions.lenient.filter(e=>void 0===e||null===e||"object"!=typeof e||void 0===e.length||e.filter(e=>void 0===e||null===e||"string"!=typeof e).length>0)),!1;if(void 0===e.abilityList||null===e.abilityList||"object"!=typeof e.abilityList||void 0===e.abilityList.length)return console.log("Assistant's Affix Database must contain a list property called 'abilityList'"),!1;if(e.abilityList.filter(e=>void 0===e||null===e||"object"!=typeof e).length>0)return console.log("Assistant's Affix Database must only contain objects inside 'abilityList'"),console.log(e.abilityList.filter(e=>void 0===e||null===e||"object"!=typeof e)),!1;if(e.abilityList.filter(e=>void 0===e.code||null===e.code||"string"!=typeof e.code).length>0)return console.log("Assistant's Affix Database must contain a string property called 'code' for every item inside 'abilityList'"),console.log(e.abilityList.filter(e=>void 0===e.code||null===e.code||"string"!=typeof e.code)),!1;if(e.abilityList.filter(e=>void 0===e.name||null===e.name||"string"!=typeof e.name).length>0)return console.log("Assistant's Affix Database must contain a string property called 'name' for every item inside 'abilityList'"),console.log(e.abilityList.filter(e=>void 0===e.name||null===e.name||"string"!=typeof e.name)),!1;if(e.abilityList.filter(e=>void 0===e.effect||null===e.effect||"string"!=typeof e.effect).length>0)return console.log("Assistant's Affix Database must contain a string property called 'effect' for every item inside 'abilityList'"),console.log(e.abilityList.filter(e=>void 0===e.effect||null===e.effect||"string"!=typeof e.effect)),!1;if(void 0===e.abilityFactor||"object"!=typeof e.abilityFactor)return console.log("Assistant's Affix Database must contain an object property called 'abilityFactor'"),!1;if(e.abilityFactor.filter(e=>void 0===e.name||null===e.name||"string"!=typeof e.name).length>0)return console.log("Assistant's Affix Database must contain a string property called 'name' for every item inside 'abilityFactor'"),console.log(e.abilityFactor.filter(e=>void 0===e.name||null===e.name||"string"!=typeof e.name)),!1;var n=g(e.optionList.support,1);if((s=n.map(e=>e.ref).sort((e,t)=>e-t)).filter(e=>"number"!=typeof e).length>0)return console.log("Assistant's Affix Database must contain a numeric property called 'ref' for every item in 'optionList.support'"),console.log(n.filter(e=>void 0===e.ref||null===e.ref||"number"!=typeof e.ref)),!1;if(s.length>0&&0!=s[0])return console.log("Assistant's Affix Database must contain a starting item with a ref value of 0 in 'optionList.support'"),console.log(n.filter(e=>e.ref===s[0])),!1;if(s.length!==new Set(s).size){console.log("Assistant's Affix Database must not contain duplicate refs in 'optionList.support', but contained duplicate refs.");let e=[];for(var i=1;i<s.length;i++){let t=s[i-1],n=s[i];t!=n||e.includes(n)||e.push(n)}return console.log(e),console.log(n.filter(t=>e.includes(t.ref))),!1}for(var i=1;i<s.length;i++){let e=s[i-1],t=s[i];if(t-e!=1)return console.log("Assistant's Affix Database must not skip refs in 'optionList.support', but skipped ref "+(e+1)),console.log("... "+e+" .. ("+(e+1)+"?) .. "+t+" ..."),!1}var o=g(e.optionList.potential,1);if((s=o.map(e=>e.ref).sort((e,t)=>e-t)).filter(e=>"number"!=typeof e).length>0)return console.log("Assistant's Affix Database must contain a numeric property called 'ref' for every item in 'optionList.potential'"),console.log(o.filter(e=>void 0===e.ref||"number"!=typeof e.ref)),!1;if(s.length>0&&0!=s[0])return console.log("Assistant's Affix Database must contain a starting item with a ref value of 0 in 'optionList.potential'"),console.log(o.filter(e=>e.ref===s[0])),!1;if(s.length!==new Set(s).size){console.log("Assistant's Affix Database must not contain duplicate refs in 'optionList.potential', but contained duplicate refs.");let e=[];for(var i=1;i<s.length;i++){let t=s[i-1],n=s[i];t!=n||e.includes(n)||e.push(n)}return console.log(e),console.log(o.filter(t=>e.includes(t.ref))),!1}for(var i=1;i<s.length;i++){let e=s[i-1],t=s[i];if(t-e!=1)return console.log("Assistant's Affix Database must not skip refs in 'optionList.potential', but skipped ref "+(e+1)),console.log("... "+e+" .. ("+(e+1)+"?) .. "+t+" ..."),!1}var s,l=g(e.abilityList,1);if((s=l.map(e=>e.ref).sort((e,t)=>e-t)).filter(e=>"number"!=typeof e).length>0)return console.log("Assistant's Affix Database must contain a numeric property called 'ref' for every item in 'abilityList'"),console.log(l.filter(e=>void 0===e.ref||null===e.ref||"number"!=typeof e.ref)),!1;if(s.length>0&&0!=s[0])return console.log("Assistant's Affix Database must contain a starting item with a ref value of 0 in 'abilityList'"),console.log(l.filter(e=>e.ref===s[0])),!1;if(s.length!==new Set(s).size){console.log("Assistant's Affix Database must not contain duplicate refs in 'abilityList', but contained duplicate refs.");let e=[];for(var i=1;i<s.length;i++){let t=s[i-1],n=s[i];t!=n||e.includes(n)||e.push(n)}return console.log(e),console.log(l.filter(t=>e.includes(t.ref))),!1}let a=l.map(e=>e.simCode?e.simCode:e.code).sort();if(a.length!==new Set(a).size){console.log("Assistant's Affix Database must not contain duplicate codes/simCodes in 'abilityList', but contained duplicate codes.");let e=[];for(var i=1;i<a.length;i++){let t=a[i-1],n=a[i];t!=n||e.includes(n)||e.push(n)}return console.log(e),console.log(l.filter(t=>t.simCode?e.includes(t.simCode):e.includes(t.code))),!1}for(var i=1;i<s.length;i++){let e=s[i-1],t=s[i];if(t-e!=1)return console.log("Assistant's Affix Database must not skip refs in 'abilityList', but skipped ref "+(e+1)),console.log("... "+e+" .. ("+(e+1)+"?) .. "+t+" ..."),!1}var d=g(e.optionList.additional,1),r=d.filter(e=>"Nothing"!==e.id).map(e=>e.ref).sort((e,t)=>e-t);if(r.filter(e=>"number"!=typeof e).length>0)return console.log("Assistant's Affix Database must contain a numeric property called 'ref' for every item (except for the item with id 'Nothing') in 'optionList.additional'"),console.log(d.filter(e=>void 0===e.ref||null===e.ref||"number"!=typeof e.ref)),!1;if(r.length!==new Set(r).size){console.log("Assistant's Affix Database must not contain duplicate refs in 'optionList.additional', but contained duplicate refs.");let e=[];for(var i=1;i<r.length;i++){let t=r[i-1],n=r[i];t!=n||e.includes(n)||e.push(n)}return console.log(e),console.log(d.filter(t=>e.includes(t.ref))),!1}for(var i in r){if(!s.includes(r[i]))return console.log("Assistant's Affix Database must not contain a ref in 'optionList.additional' that does not match any ref in 'abilityList', but contains ref "+r[i]),!1;let e=l.filter(e=>e.ref==r[i])[0],t=d.filter(e=>e.ref==r[i])[0];if(e.name!==t.name)return console.log("Assistant's Affix Database must not contain a ref in 'optionList.additional' that does not match the name of the item with the matching ref in 'abilityList'"),console.log("ref: "+r[i]+"; "+e.name+" != "+t.name),!1}if(void 0===e.abilityFactor||null===e.abilityFactor||"object"!=typeof e.abilityFactor||void 0===e.abilityFactor.length||null===e.abilityFactor.length||"number"!=typeof e.abilityFactor.length)return console.log("Assistant's Affix Database must contain a list property called 'abilityFactor'"),!1;if(e.abilityFactor.filter(e=>void 0===e||null===e||"object"!=typeof e||void 0===e.name||null===e.name||"string"!=typeof e.name||0==e.name.length).length>0)return console.log("Assistant's Affix Database must contain only contain objects with string property 'name' in 'abilityFactor',but contained:"),console.log(e.abilityFactor.filter(e=>void 0===e||null===e||"object"!=typeof e||void 0===e.name||null===e.name||"string"!=typeof e.name||0==e.name.length)),!1;for(var i in e.abilityFactor){let t=e.abilityFactor[i].name;if(0==l.filter(e=>e.name==t).length)return console.log("Assistant's Affix Database must contain an ability in 'abilityList' with matching name for every item name in 'abilityFactor', but did not contain: "+t),!1}if(void 0===t||null===t||"object"!=typeof t)return console.log("Assistant's Affix Database must contain a localizable language data structure named 'lang'"),!1;if(void 0===t.support||null===t.support||"object"!=typeof t.support)return console.log("Assistant's Affix Database must contain an object property called 'support' in the localizable language data structure 'lang'"),!1;if(void 0===t.additional||null===t.additional||"object"!=typeof t.additional)return console.log("Assistant's Affix Database must contain an object property called 'additional' in the localizable language data structure 'lang'"),!1;if(void 0===t.potential||null===t.potential||"object"!=typeof t.potential)return console.log("Assistant's Affix Database must contain an object property called 'potential' in the localizable language data structure 'lang'"),!1;let c=["app","filters","statsDisplayOrder","synonyms"],p=["support","additional","potential"];if(Object.keys(t).filter(e=>!(c.includes(e)||p.includes(e)||void 0!==t[e]&&null!==t[e]&&"object"==typeof t[e]&&void 0!==t[e].name_en&&null!==t[e].name_en&&"string"==typeof t[e].name_en&&void 0!==t[e].name_jp&&null!==t[e].name_jp&&"string"==typeof t[e].name_jp&&void 0!==t[e].effect_en&&null!==t[e].effect_en&&"string"==typeof t[e].effect_en&&void 0!==t[e].effect_jp&&null!==t[e].effect_jp&&"string"==typeof t[e].effect_jp)).length>0)return console.log("Assistant's Affix Database must only contain object properties in 'lang' named 'app', 'filters', 'statsDisplayOrder', 'synonyms', 'support', 'additional', 'potential', and any other property must follow the format:\n    \"{{ability_code}}\": {\n        name_en: \"{{ability_name_as_in_affixData_abilityList_code}}\",\n        name_jp: \"{{ability_name_in_japanese}}\",\n        effect_en: \"{{ability_effect_in_english}}\",\n        effect_jp: \"{{ability_effect_in_japanese}}\"\n    }\nBut contained the following items:"),console.log(Object.keys(t).filter(e=>!(c.includes(e)||p.includes(e)||void 0!==t[e]&&null!==t[e]&&"object"==typeof t[e]&&void 0!==t[e].name_en&&null!==t[e].name_en&&"object"==typeof t[e].name_en&&void 0!==t[e].name_jp&&null!==t[e].name_jp&&"object"==typeof t[e].name_jp&&void 0!==t[e].effect_en&&null!==t[e].effect_en&&"object"==typeof t[e].effect_en&&void 0!==t[e].effect_jp&&null!==t[e].effect_jp&&"object"==typeof t[e].effect_jp))),!1;if(Object.keys(t.support).filter(e=>void 0===t.support[e]||null===t.support[e]||"object"!=typeof t.support[e]||void 0===t.support[e].en||null===t.support[e].en||"string"!=typeof t.support[e].en||void 0===t.support[e].jp||null===t.support[e].jp||"string"!=typeof t.support[e].jp).length>0)return console.log('Assistant\'s Affix Database must only contain object properties in \'lang.support\' in the following format:\n    "{{support_item_id_as_in_affixData_optionList_support_id}}": {\n        en: "{{support_item_id_in_english}}",\n        jp: "{{support_item_id_in_japanese}}"\n    },\nBut contained the following items:'),console.log(Object.keys(t.support).filter(e=>void 0===t.support[e]||null===t.support[e]||"object"!=typeof t.support[e]||void 0===t.support[e].en||null===t.support[e].en||"string"!=typeof t.support[e].en||void 0===t.support[e].jp||null===t.support[e].jp||"string"!=typeof t.support[e].jp)),!1;if(Object.keys(t.additional).filter(e=>void 0===t.additional[e]||null===t.additional[e]||"object"!=typeof t.additional[e]||void 0===t.additional[e].en||null===t.additional[e].en||"string"!=typeof t.additional[e].en||void 0===t.additional[e].jp||null===t.additional[e].jp||"string"!=typeof t.additional[e].jp).length>0)return console.log('Assistant\'s Affix Database must only contain object properties in \'lang.additional\' in the following format:\n    "{{add_ability_id_as_in_affixData_optionList_additional_id}}": {\n        en: "{{add_ability_id_in_english}}",\n        jp: "{{add_ability_id_in_japanese}}"\n    },\nBut contained the following items:'),console.log(Object.keys(t.additional).filter(e=>void 0===t.additional[e]||null===t.additional[e]||"object"!=typeof t.additional[e]||void 0===t.additional[e].en||null===t.additional[e].en||"string"!=typeof t.additional[e].en||void 0===t.additional[e].jp||null===t.additional[e].jp||"string"!=typeof t.additional[e].jp)),!1;if(Object.keys(t.potential).filter(e=>void 0===t.potential[e]||null===t.potential[e]||"object"!=typeof t.potential[e]||void 0===t.potential[e].en||null===t.potential[e].en||"string"!=typeof t.potential[e].en||void 0===t.potential[e].jp||null===t.potential[e].jp||"string"!=typeof t.potential[e].jp).length>0)return console.log('Assistant\'s Affix Database must only contain object properties in \'lang.potential\' in the following format:\n    "{{potential_id_as_in_affixData_optionList_potential_id}}": {\n        en: "{{potential_id_in_english}}",\n        jp: "{{potential_id_in_japanese}}"\n    },\nBut contained the following items:'),console.log(Object.keys(t.potential).filter(e=>void 0===t.potential[e]||null===t.potential[e]||"object"!=typeof t.potential[e]||void 0===t.potential[e].en||null===t.potential[e].en||"string"!=typeof t.potential[e].en||void 0===t.potential[e].jp||null===t.potential[e].jp||"string"!=typeof t.potential[e].jp)),!1;var u;if((u=l.filter(e=>{let n=t[e.code];return void 0===n||null===n||"object"!=typeof n||void 0===n.name_en||null===n.name_en||"string"!=typeof n.name_en||0==n.name_en.length||n.name_en!=e.name||void 0===n.name_jp||null===n.name_jp||"string"!=typeof n.name_jp||0==n.name_jp.length||void 0===n.effect_en||null===n.effect_en||"string"!=typeof n.effect_en||0==n.effect_en.length||void 0===n.effect_jp||null===n.effect_jp||"string"!=typeof n.effect_jp||0==n.effect_jp.length})).length>0)return console.log('Assistant\'s Affix Database must contain a localizable object in \'lang\' for every ability code in \'abilityList\' in the following format:\n    "{{ability_code}}": {\n        name_en: "{{ability_name_as_in_affixData_abilityList_code}}",\n        name_jp: "{{ability_name_in_japanese}}",\n        effect_en: "{{ability_effect_in_english}}",\n        effect_jp: "{{ability_effect_in_japanese}}"\n    }\nBut did not contain one for the following items:'),console.log(u),!1;if((u=n.filter(e=>{let n=t.support[e.id];return void 0===n||null===n||"object"!=typeof n||void 0===n.en||null===n.en||"string"!=typeof n.en||0==n.en.length||n.en!=e.id||void 0===n.jp||null===n.jp||"string"!=typeof n.jp||0==n.jp.length})).length>0)return console.log('Assistant\'s Affix Database must contain a localizable object in \'lang.support\' for every Support Item id in \'optionList.support\' in the following format:\n    "{{support_item_id_as_in_affixData_optionList_support_id}}": {\n        en: "{{support_item_id_in_english}}",\n        jp: "{{support_item_id_in_japanese}}"\n    },\nBut did not contain one for the following items:'),console.log(u),!1;if((u=d.filter(e=>{let n=t.additional[e.id];return void 0===n||null===n||"object"!=typeof n||void 0===n.en||null===n.en||"string"!=typeof n.en||0==n.en.length||n.en!=e.id||void 0===n.jp||null===n.jp||"string"!=typeof n.jp||0==n.jp.length})).length>0)return console.log('Assistant\'s Affix Database must contain a localizable object in \'lang.additional\' for every Add Ability Item id in \'optionList.additional\' in the following format:\n    "{{add_ability_id_as_in_affixData_optionList_additional_id}}": {\n        en: "{{add_ability_id_in_english}}",\n        jp: "{{add_ability_id_in_japanese}}"\n    },\nBut did not contain one for the following items:'),console.log(u),!1;if((u=o.filter(e=>{let n=t.potential[e.id];return void 0===n||null===n||"object"!=typeof n||void 0===n.en||null===n.en||"string"!=typeof n.en||0==n.en.length||n.en!=e.id||void 0===n.jp||null===n.jp||"string"!=typeof n.jp||0==n.jp.length})).length>0)return console.log('Assistant\'s Affix Database must contain a localizable object in \'lang.potential\' for every Potential id in \'optionList.potential\' in the following format:\n    "{{potential_id_as_in_affixData_optionList_potential_id}}": {\n        en: "{{potential_id_in_english}}",\n        jp: "{{pontential_id_in_japanese}}"\n    },\nBut did not contain one for the following items:'),console.log(u),!1;let f=[],y=[],m=[],h=[];for(var A in t)if(!c.includes(A))if("support"!==A)if("additional"!==A)if("potential"!==A)0==l.filter(e=>e.code==A).length&&h.push(A);else for(var b in t[A])0==o.filter(e=>e.id==b).length&&m.push(b);else for(var b in t[A])0==d.filter(e=>e.id==b).length&&y.push(b);else for(var b in t[A])0==n.filter(e=>e.id==b).length&&f.push(b);if(f.length>0)return console.log("Assistant's Affix Database must not contain a localizable language object in 'lang.support' for a Support Item id not listed in 'optionList.support', but contained the following:"),console.log(f),!1;if(y.length>0)return console.log("Assistant's Affix Database must not contain a localizable language object in 'lang.additional' for an Add Ability Item id not listed in 'optionList.additional', but contained the following:"),console.log(y),!1;if(m.length>0)return console.log("Assistant's Affix Database must not contain a localizable language object in 'lang.potential' for a Potential id not listed in 'optionList.potential', but contained the following:"),console.log(m),!1;if(h.length>0)return console.log("Assistant's Affix Database must not contain a localizable language object in 'lang' for an ability code not listed in 'abilityList', but contained the following:"),console.log(h),!1;return!0}(s.data,l.lang)){console.log("Fetching updates...");var t=(i,o)=>{if(null===i)return void n.question("Could not fetch data from PSO2 Affixing Simulator. Press 'Y' to try again or any key to quit...",function(e){"Y"===e||"y"===e?u(t):process.exit()});if(null===o)return void n.question("Could not fetch data from PSO2 Swiki. Press 'Y' to try again or any key to quit...",function(e){"Y"===e||"y"===e?u(t):process.exit()});console.log("Checking updates...");let a=function(e,t,n){if(!(e&&t&&e.abilityList&&t.abilityList&&e.abilityList.length&&t.abilityList.length))return console.warn("WARN Illegal Argument passed to checkUpdates"),console.warn(" - Usage: checkUpdates(ast, sim, $swiki)"),console.warn("   - ast: The affix assistant database"),console.warn("   - sim: The affix simulator database to compare to"),console.warn("   - $swiki: The jQuery object representing the PSO2 Swiki website"),null;let i={support:{outdatedInSim:[],outdatedInAst:[],inconclusiveInAst:[],inconclusiveInSim:[],codeChanges:[]},additional:{outdatedInSim:[],outdatedInAst:[],inconclusiveInAst:[],inconclusiveInSim:[],codeChanges:[]},potential:{outdatedInSim:[],outdatedInAst:[],inconclusiveInAst:[],inconclusiveInSim:[],codeChanges:[]},extendAbility:{outdatedInSim:[],outdatedInAst:[],inconclusiveInAst:[],inconclusiveInSim:[]},excludePattern:{addition:{outdatedInSim:[],outdatedInAst:[],inconclusiveInAst:[],inconclusiveInSim:[]},select:{outdatedInSim:[],outdatedInAst:[],inconclusiveInAst:[],inconclusiveInSim:[]}},extraSlot:{outdatedInSim:[],outdatedInAst:[],inconclusiveInAst:[],inconclusiveInSim:[]},sameBonusBoost:{outdatedInSim:[],outdatedInAst:[],inconclusiveInAst:[],inconclusiveInSim:[]},boostPoint:{},ability:{outdatedInSim:[],outdatedInAst:[],inconclusiveInAst:[],inconclusiveInSim:[],codeChanges:[]},abilityFactorsMissingInAst:[],addAbilitiesMissingInAst:[]};for(var o=0;o<t.abilityList.length;o++){let n=t.abilityList[o];if(c.filter(e=>e.simName==n.name).length>0)continue;if(!n||!n.name){i.ability.inconclusiveInSim.push(n);continue}let l=!1;for(var s=0;s<e.abilityList.length;s++){let t=e.abilityList[s];t&&t.name?(n.name==t.name||n.name.includes(t.name)||t.name.includes(n.name))&&(l=!0):i.ability.inconclusiveInAst.push(t)}l||i.ability.outdatedInAst.push(n)}for(var o=0;o<e.abilityList.length;o++){let n=e.abilityList[o];if(!n||!n.name)continue;let l=c.filter(e=>e.astName==n.name);if(l.length>0&&(l[0].ignoreType!==r.pendingInSim||!t.abilityList.map(e=>e.name).includes(n.name)))continue;let a=!1,d=null;for(var s=0;s<t.abilityList.length;s++){let e=t.abilityList[s];e&&e.name&&((e.name==n.name||e.name.includes(n.name)||n.name.includes(e.name))&&(a=!0),e.name==n.name&&e.code!=n.code&&e.code!=n.simCode&&0==c.filter(t=>t.ignoreType===r.dupCodeInSim&&t.simCode==e.code&&t.astCode==(n.simCode?n.simCode:n.code)).length&&(d=n.name+":"+(n.simCode?n.simCode:n.code)+" -> "+e.name+":"+e.code))}a?d&&i.ability.codeChanges.push(d):i.ability.outdatedInSim.push(n)}for(var o=0;t.optionList&&t.optionList.support&&o<t.optionList.support.length;o++){let n=t.optionList.support[o];if(!n||!n.id||!n.value){i.support.inconclusiveInSim.push(n);continue}let l=c.filter(e=>e.simSupId==n.id);if(l.length>0&&(void 0===l[0].astSupId||e.optionList.support.map(e=>e.id).includes(l[0].astSupId)))continue;let a=!1;for(var s=0;e.optionList&&e.optionList.support&&s<e.optionList.support.length;s++){let t=e.optionList.support[s];t&&t.id?(n.id==t.id||n.id.includes(t.id)||t.id.includes(n.id))&&(a=!0):i.support.inconclusiveInAst.push(t)}a||i.support.outdatedInAst.push(n)}for(var o=0;e.optionList&&e.optionList.support&&o<e.optionList.support.length;o++){let n=e.optionList.support[o];if(!n||!n.id)continue;let l=c.filter(e=>e.astSupId==n.id);if(l.length>0&&(void 0===l[0].simSupId||t.optionList.support.map(e=>e.id).includes(l[0].simSupId)))continue;let a=!1,d=null;for(var s=0;t.optionList&&t.optionList.support&&s<t.optionList.support.length;s++){let e=t.optionList.support[s];e&&e.id&&e.value&&((e.id==n.id||e.id.includes(n.id)||n.id.includes(e.id))&&(a=!0),e.id==n.id&&e.value!=n.value&&e.value!=n.simValue&&(d=n.id+":"+n.value+" -> "+e.id+":"+e.value))}a?d&&i.support.codeChanges.push(d):i.support.outdatedInSim.push(n)}for(var o=0;t.optionList&&t.optionList.additional&&o<t.optionList.additional.length;o++){let n=t.optionList.additional[o];if(!n||!n.id||!n.value){i.additional.inconclusiveInSim.push(n);continue}let l=c.filter(e=>e.simAddId==n.id);if(l.length>0&&(void 0===l[0].astAddId||e.optionList.additional.map(e=>e.id).includes(l[0].astAddId)))continue;let a=!1;for(var s=0;e.optionList&&e.optionList.additional&&s<e.optionList.additional.length;s++){let t=e.optionList.additional[s];t&&t.id?(n.id==t.id||n.id.includes(t.id)||t.id.includes(n.id))&&(a=!0):i.additional.inconclusiveInAst.push(t)}a||i.additional.outdatedInAst.push(n)}for(var o=0;e.optionList&&e.optionList.additional&&o<e.optionList.additional.length;o++){let n=e.optionList.additional[o];if(!n||!n.id)continue;let l=c.filter(e=>e.astAddId==n.id);if(l.length>0&&(void 0===l[0].simAddId||t.optionList.additional.map(e=>e.id).includes(l[0].simAddId)))continue;let a=!1,d=null;for(var s=0;t.optionList&&t.optionList.additional&&s<t.optionList.additional.length;s++){let e=t.optionList.additional[s];e&&e.id&&e.value&&((e.id==n.id||e.id.includes(n.id)||n.id.includes(e.id))&&(a=!0),e.id==n.id&&e.value!=n.value&&e.value!=n.simValue&&(d=n.id+":"+n.value+" -> "+e.id+":"+e.value))}a?d&&i.additional.codeChanges.push(d):i.additional.outdatedInSim.push(n)}for(var o=0;t.optionList&&t.optionList.potential&&o<t.optionList.potential.length;o++){let n=t.optionList.potential[o];if(!n||!n.id||!n.value){i.potential.inconclusiveInSim.push(n);continue}let l=c.filter(e=>e.simPotId==n.id);if(l.length>0&&(void 0===l[0].astPotId||e.optionList.potential.map(e=>e.id).includes(l[0].astPotId)))continue;let a=!1;for(var s=0;e.optionList&&e.optionList.potential&&s<e.optionList.potential.length;s++){let t=e.optionList.potential[s];t&&t.id?(n.id==t.id||n.id.includes(t.id)||t.id.includes(n.id))&&(a=!0):i.potential.inconclusiveInAst.push(t)}a||i.potential.outdatedInAst.push(n)}for(var o=0;e.optionList&&e.optionList.potential&&o<e.optionList.potential.length;o++){let n=e.optionList.potential[o];if(!n||!n.id)continue;let l=c.filter(e=>e.astPotId==n.id);if(l.length>0&&(void 0===l[0].simPotId||t.optionList.potential.map(e=>e.id).includes(l[0].simPotId)))continue;let a=!1,d=null;for(var s=0;t.optionList&&t.optionList.potential&&s<t.optionList.potential.length;s++){let e=t.optionList.potential[s];e&&e.id&&e.value&&((e.id==n.id||e.id.includes(n.id)||n.id.includes(e.id))&&(a=!0),e.id==n.id&&e.value!=n.value&&e.value!=n.simValue&&(d=n.id+":"+n.value+" -> "+e.id+":"+e.value))}a?d&&i.potential.codeChanges.push(d):i.potential.outdatedInSim.push(n)}for(var o=0;t.extendAbility&&o<t.extendAbility.length;o++){let n=t.extendAbility[o];if(!(n&&n.base&&n.ref&&n.success)){i.extendAbility.inconclusiveInSim.push(n);continue}let s=e.extendAbility.filter(e=>e.success===n.success).filter(e=>"object"==typeof n.ref?0===n.ref.filter(t=>n.ref.filter(e=>e===t).length!==("object"==typeof e.ref?e.ref.filter(e=>e===t).length:e.ref===t?1:0)).length:"object"==typeof e.ref?1===e.ref.filter(e=>e===n.ref).length:e.ref===n.ref).filter(e=>"object"==typeof n.base?0===n.base.filter(t=>n.base.filter(e=>e===t).length!==("object"==typeof e.base?e.base.filter(e=>e===t).length:e.base===t?1:0)).length:"object"==typeof e.base?1===e.base.filter(e=>e===n.base).length:e.base===n.base);1!==s.length&&i.extendAbility.outdatedInAst.push(n)}for(var o=0;e.extendAbility&&o<e.extendAbility.length;o++){let n=e.extendAbility[o];if(!(n&&n.base&&n.ref&&n.success))continue;let s=t.extendAbility.filter(e=>e.success===n.success).filter(e=>"object"==typeof n.ref?0===n.ref.filter(t=>n.ref.filter(e=>e===t).length!==("object"==typeof e.ref?e.ref.filter(e=>e===t).length:e.ref===t?1:0)).length:"object"==typeof e.ref?1===e.ref.filter(e=>e===n.ref).length:e.ref===n.ref).filter(e=>"object"==typeof n.base?0===n.base.filter(t=>n.base.filter(e=>e===t).length!==("object"==typeof e.base?e.base.filter(e=>e===t).length:e.base===t?1:0)).length:"object"==typeof e.base?1===e.base.filter(e=>e===n.base).length:e.base===n.base);1!==s.length&&i.extendAbility.outdatedInSim.push(n)}for(var o=0;t.excludePattern.addition&&o<t.excludePattern.addition.length;o++){let n=t.excludePattern.addition[o];if(!n){i.excludePattern.addition.inconclusiveInSim.push(n);continue}let s=e.excludePattern.addition.filter(e=>typeof e==typeof n&&("object"==typeof n?0===n.filter(t=>n.filter(e=>e===t).length!==("object"==typeof e?e.filter(e=>e===t).length:e===t?1:0)).length:"object"==typeof e?1===e.filter(e=>e===n).length:e===n));1!==s.length&&0===c.filter(e=>typeof e==typeof n&&e.simExcludePatternAdd&&("object"==typeof n?0===n.filter(t=>n.filter(e=>e===t).length!==("object"==typeof e.simExcludePatternAdd?e.simExcludePatternAdd.filter(e=>e===t).length:e.simExcludePatternAdd===t?1:0)).length:"object"==typeof e.simExcludePatternAdd?1===e.simExcludePatternAdd.filter(e=>e===n).length:e.simExcludePatternAdd===n)).length&&i.excludePattern.addition.outdatedInAst.push(n)}for(var o=0;e.excludePattern.addition&&o<e.excludePattern.addition.length;o++){let n=e.excludePattern.addition[o];if(!n){i.excludePattern.addition.inconclusiveInAst.push(n);continue}let s=t.excludePattern.addition.filter(e=>typeof e==typeof n&&("object"==typeof n?0===n.filter(t=>n.filter(e=>e===t).length!==("object"==typeof e?e.filter(e=>e===t).length:e===t?1:0)).length:"object"==typeof e?1===e.filter(e=>e===n).length:e===n));1!==s.length&&0===c.filter(e=>typeof e==typeof n&&e.astExcludePatternAdd&&("object"==typeof n?0===n.filter(t=>n.filter(e=>e===t).length!==("object"==typeof e.astExcludePatternAdd?e.astExcludePatternAdd.filter(e=>e===t).length:e.astExcludePatternAdd===t?1:0)).length:"object"==typeof e.astExcludePatternAdd?1===e.astExcludePatternAdd.filter(e=>e===n).length:e.astExcludePatternAdd===n)).length&&i.excludePattern.addition.outdatedInSim.push(n)}for(var o=0;t.excludePattern.select&&o<t.excludePattern.select.length;o++){let n=t.excludePattern.select[o];if(!n){i.excludePattern.select.inconclusiveInSim.push(n);continue}let s=e.excludePattern.select.filter(e=>typeof e==typeof n&&("object"==typeof n?0===n.filter(t=>n.filter(e=>e===t).length!==("object"==typeof e?e.filter(e=>e===t).length:e===t?1:0)).length:"object"==typeof e?1===e.filter(e=>e===n).length:e===n));1!==s.length&&0===c.filter(e=>typeof e==typeof n&&e.simExcludePatternSel&&("object"==typeof n?0===n.filter(t=>n.filter(e=>e===t).length!==("object"==typeof e.simExcludePatternSel?e.simExcludePatternSel.filter(e=>e===t).length:e.simExcludePatternSel===t?1:0)).length:"object"==typeof e.simExcludePatternSel?1===e.simExcludePatternSel.filter(e=>e===n).length:e.simExcludePatternSel===n)).length&&i.excludePattern.select.outdatedInAst.push(n)}for(var o=0;e.excludePattern.select&&o<e.excludePattern.select.length;o++){let n=e.excludePattern.select[o];if(!n){i.excludePattern.select.inconclusiveInAst.push(n);continue}let s=t.excludePattern.select.filter(e=>typeof e==typeof n&&("object"==typeof n?0===n.filter(t=>n.filter(e=>e===t).length!==("object"==typeof e?e.filter(e=>e===t).length:e===t?1:0)).length:"object"==typeof e?1===e.filter(e=>e===n).length:e===n));1!==s.length&&0===c.filter(e=>typeof e==typeof n&&e.astExcludePatternSel&&("object"==typeof n?0===n.filter(t=>n.filter(e=>e===t).length!==("object"==typeof e.astExcludePatternSel?e.astExcludePatternSel.filter(e=>e===t).length:e.astExcludePatternSel===t?1:0)).length:"object"==typeof e.astExcludePatternSel?1===e.astExcludePatternSel.filter(e=>e===n).length:e.astExcludePatternSel===n)).length&&i.excludePattern.select.outdatedInSim.push(n)}let a=e=>void 0!==e&&null!==e&&"object"==typeof e&&void 0!==e.true&&null!==e.true&&"number"==typeof e.true&&void 0!==e.false&&null!==e.false&&"number"==typeof e.false,d=t.extraSlot.filter(e=>a(e));d.length!==t.extraSlot.length&&(i.extraSlot.inconclusiveInSim=t.extraSlot.filter(e=>!a(e)));let u=e.extraSlot.filter(e=>a(e));u.length!==e.extraSlot.length&&(i.extraSlot.inconclusiveInAst=e.extraSlot.filter(e=>!a(e)));i.extraSlot.outdatedInAst=d.filter(e=>0===u.filter(t=>e.true===t.true&&e.false===t.false).length),i.extraSlot.outdatedInSim=u.filter(e=>0===d.filter(t=>e.true===t.true&&e.false===t.false).length);let f=e=>void 0!==e&&null!==e&&"number"==typeof e,g=t.sameBonusBoost.filter(e=>f(e));g.length!==t.sameBonusBoost.length&&(i.sameBonusBoost.inconclusiveInSim=t.sameBonusBoost.filter(e=>!f(e)));let y=e.sameBonusBoost.filter(e=>f(e));y.length!==e.sameBonusBoost.length&&(i.sameBonusBoost.inconclusiveInAst=e.sameBonusBoost.filter(e=>!f(e)));i.sameBonusBoost.outdatedInAst=g.filter(e=>0===y.filter(t=>e===t).length),i.sameBonusBoost.outdatedInSim=y.filter(e=>0===g.filter(t=>e===t).length);let m=function(e,t){var n,i;return n=[],i=[],function e(t,o,s){var l;if(isNaN(t)&&isNaN(o)&&"number"==typeof t&&"number"==typeof o)return{valueInSim:t,valueInAst:o};if(t===o)return{valueInSim:t,valueInAst:o};if("function"==typeof t&&"function"==typeof o||t instanceof Date&&o instanceof Date||t instanceof RegExp&&o instanceof RegExp||t instanceof String&&o instanceof String||t instanceof Number&&o instanceof Number)return t.toString(),o.toString(),{valueInSim:t,valueInAst:o};if(!(t instanceof Object&&o instanceof Object))return{valueInSim:t,valueInAst:o};if(t.isPrototypeOf(o)||o.isPrototypeOf(t))return{valueInSim:t,valueInAst:o};if(t.constructor!==o.constructor)return{valueInSim:t,valueInAst:o};if(t.prototype!==o.prototype)return{valueInSim:t,valueInAst:o};if(n.indexOf(t)>-1||i.indexOf(o)>-1)return{valueInSim:t,valueInAst:o};let a={};for(l in o)o.hasOwnProperty(l)!==t.hasOwnProperty(l)?a[l]={valueInSim:t[l],valueInAst:o[l]}:typeof o[l]!=typeof t[l]&&(a[l]={valueInSim:t[l],valueInAst:o[l]});for(l in t)switch(o.hasOwnProperty(l)!==t.hasOwnProperty(l)?a[l]={valueInSim:t[l],valueInAst:o[l]}:typeof o[l]!=typeof t[l]&&(a[l]={valueInSim:t[l],valueInAst:o[l]}),typeof t[l]){case"object":case"function":n.push(t),i.push(o);let s=e(t[l],o[l]);0!=Object.keys(s).length&&(a[l]=s),n.pop(),i.pop();break;default:t[l]!==o[l]&&(a[l]={valueInSim:t[l],valueInAst:o[l]})}return a}(e,t)}(t.boostPoint,e.boostPoint);Object.keys(m).length>0&&(i.boostPoint=m);let h=[],A=[],b=[],v=null,S=n("div.ie5 > table.style_table > tbody");for(var o=0;o<S.length;o++){let e=S.get(o),t=null;for(var s=0;s<e.children.length;s++){let i=e.children[s];if(i.children.length>0&&"特殊能力因子"===n(i.children[0]).text())v="saf";else if(i.children.length>0&&"能力追加アイテム"===n(i.children[0]).text())v="add";else if(i.children.length>0&&"ドロップ付与"===n(i.children[0]).text())v="ability";else if("saf"===v){let e=n(i).find("td.style_td:first-child > a:first-child:not(:empty)");e&&e.length>0&&h.push(e.text())}else if("add"===v){let e=n(i).find("td.style_td:first-child > a:first-child:not(:empty)");if(e&&e.length>0){let t=e.text();A.push(t)}}else if("ability"===v){let e=n(i).find("td.style_td:first-child > a:first-child:not(:empty)");if(e&&e.length>0){if(b.push(e.text()),i.children.length>3){let e=n(i.children[3]).text();t=e&&""!==e&&"-"!==e&&!A.includes(e)}else if(3===i.children.length&&"220px"===n(i.children[2]).css("width")){let e=n(i.children[2]).text();t=e&&""!==e&&"-"!==e&&!A.includes(e)}if(t){let t=e.text();A.push(t)}}}}}let x=e.abilityFactor.map(e=>e.jpName);i.abilityFactorsMissingInAst=h.filter(e=>!x.includes(e));let I=Object.values(l.lang);if(l.lang)for(var o in i.abilityFactorsMissingInAst){let e=I.filter(e=>e.name_jp===i.abilityFactorsMissingInAst[o]);e.length>0&&(i.abilityFactorsMissingInAst[o]={name:e[0].name_en,jpName:i.abilityFactorsMissingInAst[o]})}let j=Object.values(l.lang.additional).map(e=>e.jp);if(A=A.map(e=>{let t=I.filter(t=>t.name_jp===e),n=e;if(/^S[1-8]:/.test(e)&&(n=e.substr(0,2)+"追加"+e.substr(2,e.length)),t.length>0){let e=t[0].name_en;if(/^S[1-8]:/.test(t[0].name_en))return{en:e=t[0].name_en.substr(0,2)+" Add: "+t[0].name_en.substr(3,t[0].name_en.length),jp:n}}return n}),i.addAbilitiesMissingInAst=A.filter(e=>!j.includes(e.jp?e.jp:e)),l.lang){let e=Object.values(l.lang.additional);for(var o in i.addAbilitiesMissingInAst){let t=e.filter(e=>e.jp===i.addAbilitiesMissingInAst[o]);t.length>0&&(i.addAbilitiesMissingInAst[o]={en:t[0].en,jp:i.addAbilitiesMissingInAst[o]})}}let L=0;i.addAbilitiesMissingInAst=i.addAbilitiesMissingInAst.reduce((e,t)=>(e[t.en?t.en:L]=t,L++,e),{}),console.warn("WARNING: Checks for boostdaySystem are not supported yet."),console.log(p),0==i.support.outdatedInSim.length&&delete i.support.outdatedInSim;0==i.support.outdatedInAst.length&&delete i.support.outdatedInAst;0==i.support.inconclusiveInSim.length&&delete i.support.inconclusiveInSim;0==i.support.inconclusiveInAst.length&&delete i.support.inconclusiveInAst;0==i.support.codeChanges.length&&delete i.support.codeChanges;0==i.additional.outdatedInSim.length&&delete i.additional.outdatedInSim;0==i.additional.outdatedInAst.length&&delete i.additional.outdatedInAst;0==i.additional.inconclusiveInSim.length&&delete i.additional.inconclusiveInSim;0==i.additional.inconclusiveInAst.length&&delete i.additional.inconclusiveInAst;0==i.additional.codeChanges.length&&delete i.additional.codeChanges;0==i.potential.outdatedInSim.length&&delete i.potential.outdatedInSim;0==i.potential.outdatedInAst.length&&delete i.potential.outdatedInAst;0==i.potential.inconclusiveInSim.length&&delete i.potential.inconclusiveInSim;0==i.potential.inconclusiveInAst.length&&delete i.potential.inconclusiveInAst;0==i.potential.codeChanges.length&&delete i.potential.codeChanges;0==i.extendAbility.outdatedInSim.length&&delete i.extendAbility.outdatedInSim;0==i.extendAbility.outdatedInAst.length&&delete i.extendAbility.outdatedInAst;0==i.extendAbility.inconclusiveInSim.length&&delete i.extendAbility.inconclusiveInSim;0==i.extendAbility.inconclusiveInAst.length&&delete i.extendAbility.inconclusiveInAst;0==i.ability.outdatedInSim.length&&delete i.ability.outdatedInSim;0==i.ability.outdatedInAst.length&&delete i.ability.outdatedInAst;0==i.ability.inconclusiveInSim.length&&delete i.ability.inconclusiveInSim;0==i.ability.inconclusiveInAst.length&&delete i.ability.inconclusiveInAst;0==i.ability.codeChanges.length&&delete i.ability.codeChanges;0==i.excludePattern.addition.outdatedInSim.length&&delete i.excludePattern.addition.outdatedInSim;0==i.excludePattern.addition.outdatedInAst.length&&delete i.excludePattern.addition.outdatedInAst;0==i.excludePattern.addition.inconclusiveInSim.length&&delete i.excludePattern.addition.inconclusiveInSim;0==i.excludePattern.addition.inconclusiveInAst.length&&delete i.excludePattern.addition.inconclusiveInAst;0==i.excludePattern.select.outdatedInSim.length&&delete i.excludePattern.select.outdatedInSim;0==i.excludePattern.select.outdatedInAst.length&&delete i.excludePattern.select.outdatedInAst;0==i.excludePattern.select.inconclusiveInSim.length&&delete i.excludePattern.select.inconclusiveInSim;0==i.excludePattern.select.inconclusiveInAst.length&&delete i.excludePattern.select.inconclusiveInAst;0==i.extraSlot.outdatedInSim.length&&delete i.extraSlot.outdatedInSim;0==i.extraSlot.outdatedInAst.length&&delete i.extraSlot.outdatedInAst;0==i.extraSlot.inconclusiveInSim.length&&delete i.extraSlot.inconclusiveInSim;0==i.extraSlot.inconclusiveInAst.length&&delete i.extraSlot.inconclusiveInAst;0==i.sameBonusBoost.outdatedInSim.length&&delete i.sameBonusBoost.outdatedInSim;0==i.sameBonusBoost.outdatedInAst.length&&delete i.sameBonusBoost.outdatedInAst;0==i.sameBonusBoost.inconclusiveInSim.length&&delete i.sameBonusBoost.inconclusiveInSim;0==i.sameBonusBoost.inconclusiveInAst.length&&delete i.sameBonusBoost.inconclusiveInAst;0===Object.keys(i.support).length&&delete i.support;0===Object.keys(i.additional).length&&delete i.additional;0===Object.keys(i.potential).length&&delete i.potential;0===Object.keys(i.extendAbility).length&&delete i.extendAbility;0===Object.keys(i.ability).length&&delete i.ability;0===Object.keys(i.excludePattern.addition).length&&delete i.excludePattern.addition;0===Object.keys(i.excludePattern.select).length&&delete i.excludePattern.select;0===Object.keys(i.excludePattern).length&&delete i.excludePattern;0===Object.keys(i.extraSlot).length&&delete i.extraSlot;0===Object.keys(i.sameBonusBoost).length&&delete i.sameBonusBoost;0===Object.keys(i.boostPoint).length&&delete i.boostPoint;0==i.abilityFactorsMissingInAst.length&&delete i.abilityFactorsMissingInAst;0!=i.addAbilitiesMissingInAst.length&&0!==Object.keys(i.addAbilitiesMissingInAst).length||delete i.addAbilitiesMissingInAst;if(0===Object.keys(i).length)return"No pending updates from PSO2 Affixing Simulator at the moment!";return i}(s.data,i,o),g=JSON.stringify(i,null,2),y=JSON.stringify(a,null,2);e.existsSync(d)||e.mkdirSync(d),e.writeFile(d+"/simulatorDb.txt",g,function(e){});var m=()=>{console.log("Building project...");var e=(t,i,o)=>{if(t)return console.log(t),void n.question("Build failed. Press 'Y' to try again or any key to quit...",function(t){"Y"===t||"y"===t?f(e):process.exit()});console.log(i),n.question("Build complete! Press enter to quit...",function(e){process.exit()})};f(e)};null===a?n.question("Could not complete the checking phase. Press 'Y' to try again or any key to quit...",function(e){"Y"===e||"y"===e?u(t):process.exit()}):"string"==typeof a?(console.log(a),m()):(console.log("There seems to be some pending updates for the Affixing Assistant:"),console.log(y),e.writeFile(d+"/changes.txt",y,function(e){e||console.log("A copy of the pending updates has been saved to "+d+"/changes.txt"),n.question("Please review all pending updates above and restart the build process. Press 'Y' to continue building regardless or any key to quit...",function(e){"Y"===e||"y"===e?m():process.exit()})}))};u(t)}else n.question("Please review the impacted files and restart the build process. Press 'Y' to try again or any key to quit...",function(e){"Y"===e||"y"===e?(delete require.cache[require.resolve("./js/affixData")],delete require.cache[require.resolve("./js/lang")],s=require("./js/affixData"),l=require("./js/lang"),a()):process.exit()})};a()});const r={temp:0,pendingInSim:1,nameMismatch:2,astOnly:4,dupCodeInSim:5};var c=[{ignoreType:r.temp,simName:"<strike>Catalyst Receptor</strike>"},{ignoreType:r.temp,simName:"<strike>Divine Receptor</strike>"},{ignoreType:r.temp,simName:"<strike>Exceed Receptor</strike>"},{ignoreType:r.pendingInSim,astName:"Ability V"},{ignoreType:r.pendingInSim,astName:"S4:Colossal Radiance"},{ignoreType:r.pendingInSim,astName:"S4:Evasion Training"},{ignoreType:r.pendingInSim,astName:"S4:Radiant Eclipse"},{ignoreType:r.pendingInSim,astName:"S5:Anthesis Cultivation"},{ignoreType:r.pendingInSim,astName:"S6:Long Night Star"},{ignoreType:r.pendingInSim,astName:"S7:Increased Efficiency"},{ignoreType:r.pendingInSim,astName:"S7:Mind Merge"},{ignoreType:r.pendingInSim,astName:"S8:High-Minded"},{ignoreType:r.nameMismatch,astName:"Shoot Resist I",simName:"Shot Resist I"},{ignoreType:r.nameMismatch,astName:"Shoot Resist II",simName:"Shot Resist II"},{ignoreType:r.nameMismatch,astName:"Shoot Resist III",simName:"Shot Resist III"},{ignoreType:r.nameMismatch,astName:"Shoot Resist IV",simName:"Shot Resist IV"},{ignoreType:r.nameMismatch,astName:"Shoot Resist V",simName:"Shot Resist V"},{ignoreType:r.nameMismatch,astName:"S1:Vigor Enhancement",simName:"S1:Vigor Enhancment"},{ignoreType:r.nameMismatch,astName:"Doom Break 2",simName:"Doom Break II"},{ignoreType:r.nameMismatch,astName:"Ceremo Fever",simName:"Ceramo Fever"},{ignoreType:r.nameMismatch,astName:"Extreceptor",simName:"Extreme Receptor"},{ignoreType:r.nameMismatch,astAddId:"Add Ability (Grand PP)",simAddId:"Add Ability (PP/4)"},{ignoreType:r.nameMismatch,astAddId:"Add Ability (Grand HP)",simAddId:"Add Ability (HP&PP/4)"},{ignoreType:r.nameMismatch,astAddId:"Add Ability (Grand P)",simAddId:"Add Ability (S-ATK&PP/4)"},{ignoreType:r.nameMismatch,astAddId:"Add Ability (Grand S)",simAddId:"Add Ability (R-ATK&PP/4)"},{ignoreType:r.nameMismatch,astAddId:"Add Ability (Grand T)",simAddId:"Add Ability (T-ATK&PP/4)"},{ignoreType:r.nameMismatch,astExcludePatternAdd:["VA","VC"]},{ignoreType:r.nameMismatch,astExcludePatternAdd:["VA","VB"]},{ignoreType:r.nameMismatch,astExcludePatternAdd:["VB","VC"]},{ignoreType:r.nameMismatch,astExcludePatternAdd:["TA","UA","UB"],simExcludePatternAdd:["TA","U"]},{ignoreType:r.nameMismatch,astExcludePatternAdd:["XG","XI"]},{ignoreType:r.nameMismatch,astExcludePatternSel:["VA*","VB*"],simExcludePatternSel:["VB01","VA*"]},{ignoreType:r.nameMismatch,astExcludePatternSel:["VB*","VC*"],simExcludePatternSel:["VB03","VA*"]},{ignoreType:r.nameMismatch,astExcludePatternSel:["VA*","VB*"],simExcludePatternSel:["VB01","VC*"]},{ignoreType:r.nameMismatch,astExcludePatternSel:["VB*","VC*"],simExcludePatternSel:["VB03","VC*"]},{ignoreType:r.nameMismatch,astExcludePatternSel:["XG","XI"]},{ignoreType:r.astOnly,astName:"Stamina Boost"},{ignoreType:r.astOnly,astName:"Spirita Boost"},{ignoreType:r.astOnly,astName:"Power Boost"},{ignoreType:r.astOnly,astName:"Technique Boost"},{ignoreType:r.astOnly,astName:"Tenora Boost"},{ignoreType:r.astOnly,astName:"GRM Boost"},{ignoreType:r.astOnly,astName:"Yohmei Boost"},{ignoreType:r.astOnly,astName:"Noble Stamina"},{ignoreType:r.astOnly,astName:"Elegant Stamina"},{ignoreType:r.astOnly,astName:"Grace Stamina"},{ignoreType:r.astOnly,astName:"Grand Stamina"},{ignoreType:r.astOnly,astName:"Noble Power"},{ignoreType:r.astOnly,astName:"Elegant Power"},{ignoreType:r.astOnly,astName:"Grace Power"},{ignoreType:r.astOnly,astName:"Grand Power"},{ignoreType:r.astOnly,astName:"Noble Shoot"},{ignoreType:r.astOnly,astName:"Elegant Shoot"},{ignoreType:r.astOnly,astName:"Grace Shoot"},{ignoreType:r.astOnly,astName:"Grand Shoot"},{ignoreType:r.astOnly,astName:"Noble Technique"},{ignoreType:r.astOnly,astName:"Elegant Technique"},{ignoreType:r.astOnly,astName:"Grace Technique"},{ignoreType:r.astOnly,astName:"Grand Technique"},{ignoreType:r.astOnly,astName:"Grace Spirita"},{ignoreType:r.astOnly,astName:"Offense Boost"},{ignoreType:r.astOnly,astName:"Attack Boost"},{ignoreType:r.astOnly,astName:"Defense Boost"},{ignoreType:r.astOnly,astName:"Guard Boost"},{ignoreType:r.astOnly,astName:"S1:Junk"},{ignoreType:r.astOnly,astName:"S2:Junk"},{ignoreType:r.astOnly,astName:"S3:Junk"},{ignoreType:r.astOnly,astName:"S4:Junk"},{ignoreType:r.astOnly,astName:"S5:Junk"},{ignoreType:r.astOnly,astName:"S6:Junk"},{ignoreType:r.astOnly,astName:"S7:Junk"},{ignoreType:r.astOnly,astName:"S8:Junk"},{ignoreType:r.astOnly,astAddId:"S1 Add: Photon Reduction 2"},{ignoreType:r.astOnly,astAddId:"S1 Add: Brilliant Ruin 2"},{ignoreType:r.astOnly,astAddId:"S1 Add: Flowing Intent"},{ignoreType:r.astOnly,astAddId:"S1 Add: Lethal Intent"},{ignoreType:r.astOnly,astAddId:"S1 Add: Reckless Strike"},{ignoreType:r.astOnly,astAddId:"S1 Add: Eclipsing Decay"},{ignoreType:r.astOnly,astAddId:"S1 Add: Augment Intent"},{ignoreType:r.astOnly,astAddId:"S1 Add: Photon Balance"},{ignoreType:r.astOnly,astAddId:"S1 Add: Collaborator Liberator"},{ignoreType:r.astOnly,astAddId:"S2 Add: Umbrageous Melody"},{ignoreType:r.astOnly,astAddId:"S2 Add: Nature's Reduction 2"},{ignoreType:r.astOnly,astAddId:"S2 Add: Umbrageous Radiance 2"},{ignoreType:r.astOnly,astAddId:"S2 Add: Wise Skill 2"},{ignoreType:r.astOnly,astAddId:"S2 Add: Skilled Strike 2"},{ignoreType:r.astOnly,astAddId:"S2 Add: Radiant Strike 2"},{ignoreType:r.astOnly,astAddId:"S2 Add: Runner's High"},{ignoreType:r.astOnly,astAddId:"S2 Add: Skill Reduction"},{ignoreType:r.astOnly,astAddId:"S2 Add: Heavenly Keeper"},{ignoreType:r.astOnly,astAddId:"S2 Add: Flowing Armor"},{ignoreType:r.astOnly,astAddId:"S3 Add: Nature's Melody"},{ignoreType:r.astOnly,astAddId:"S3 Add: Nature's Gleam 2"},{ignoreType:r.astOnly,astAddId:"S3 Add: Flowing Grace"},{ignoreType:r.astOnly,astAddId:"S3 Add: Flowing Exhilaration 2"},{ignoreType:r.astOnly,astAddId:"S3 Add: Radiating Grace 2"},{ignoreType:r.astOnly,astAddId:"S3 Add: Calming Exhilaration"},{ignoreType:r.astOnly,astAddId:"S3 Add: Fortifying Strike"},{ignoreType:r.astOnly,astAddId:"S3 Add: Curtailed Strike"},{ignoreType:r.astOnly,astAddId:"S3 Add: Wise Strike"},{ignoreType:r.astOnly,astAddId:"S3 Add: Flowing Courage"},{ignoreType:r.astOnly,astAddId:"S4 Add: Heavenly Protection"},{ignoreType:r.astOnly,astAddId:"S4 Add: Calming Intent"},{ignoreType:r.astOnly,astAddId:"S4 Add: Mysterious Strike"},{ignoreType:r.astOnly,astAddId:"S4 Add: Saint Shield"},{ignoreType:r.astOnly,astAddId:"S4 Add: Colored Spectrum"},{ignoreType:r.astOnly,astAddId:"S4 Add: Raising Pursuit"},{ignoreType:r.astOnly,astAddId:"S5 Add: Anthesis Cultivation"},{ignoreType:r.astOnly,astAddId:"S1 Add: Wise Skill"},{ignoreType:r.astOnly,astAddId:"S1 Add: Radiating Grace"},{ignoreType:r.astOnly,astAddId:"S1 Add: Skilled Brilliance"},{ignoreType:r.astOnly,astAddId:"S1 Add: Red Petal Flash"},{ignoreType:r.astOnly,astAddId:"S1 Add: Blue Ocean Flash"},{ignoreType:r.astOnly,astAddId:"S1 Add: White Snow Flash"},{ignoreType:r.astOnly,astAddId:"S1 Add: Yellow Moon Flash"},{ignoreType:r.astOnly,astAddId:"S1 Add: Green Leaf Flash"},{ignoreType:r.astOnly,astAddId:"S1 Add: Black Shadow Flash"},{ignoreType:r.astOnly,astAddId:"S1 Add: Skilled Strike"},{ignoreType:r.astOnly,astAddId:"S1 Add: Flowing Exhilaration"},{ignoreType:r.astOnly,astAddId:"S1 Add: Guardian Armor"},{ignoreType:r.astOnly,astAddId:"S1 Add: Rupturing Excess"},{ignoreType:r.astOnly,astAddId:"S1 Add: Spirited Response"},{ignoreType:r.astOnly,astAddId:"S1 Add: Rupturing Intent"},{ignoreType:r.astOnly,astAddId:"S2 Add: Flowing Exhilaration"},{ignoreType:r.astOnly,astAddId:"S2 Add: Photon Reduction"},{ignoreType:r.astOnly,astAddId:"S2 Add: Sturdy Recovery"},{ignoreType:r.astOnly,astAddId:"S2 Add: Cursed Radiance"},{ignoreType:r.astOnly,astAddId:"S2 Add: Flowing Grace"},{ignoreType:r.astOnly,astAddId:"S2 Add: Rupturing Excess"},{ignoreType:r.astOnly,astAddId:"S2 Add: Double-Edged Sword"},{ignoreType:r.astOnly,astAddId:"S3 Add: Radiant Strike"},{ignoreType:r.astOnly,astAddId:"S3 Add: Skilled Strike"},{ignoreType:r.astOnly,astAddId:"S3 Add: Offensive Intent"},{ignoreType:r.astOnly,astAddId:"S3 Add: Vital Intent"},{ignoreType:r.astOnly,astAddId:"S3 Add: Wise Skill"},{ignoreType:r.astOnly,astAddId:"S3 Add: Rupturing Intent"},{ignoreType:r.astOnly,astAddId:"S3 Add: Brilliant Ruin"},{ignoreType:r.astOnly,astAddId:"S3 Add: Cursed Radiance"},{ignoreType:r.astOnly,astAddId:"S4 Add: Skilled Crippler"},{ignoreType:r.astOnly,astAddId:"S4 Add: Cursed Rainbow"},{ignoreType:r.astOnly,astAddId:"S4 Add: Colossal Radiance"},{ignoreType:r.astOnly,astAddId:"S4 Add: Evasion Training"},{ignoreType:r.astOnly,astAddId:"S4 Add: Radiant Eclipse"},{ignoreType:r.astOnly,astAddId:"S6 Add: Ironclad Illness"},{ignoreType:r.astOnly,astAddId:"S6 Add: Guardian Armor"},{ignoreType:r.astOnly,astAddId:"S6 Add: Heroic Howl"},{ignoreType:r.astOnly,astAddId:"S6 Add: Soaring Ballet"},{ignoreType:r.astOnly,astAddId:"S6 Add: Guardian's Essence"},{ignoreType:r.astOnly,astAddId:"S6 Add: Evasion Whistle"},{ignoreType:r.astOnly,astAddId:"S6 Add: Long Night Star"},{ignoreType:r.astOnly,astAddId:"S7 Add: S-ATK Up"},{ignoreType:r.astOnly,astAddId:"S7 Add: R-ATK Up"},{ignoreType:r.astOnly,astAddId:"S7 Add: T-ATK Up"},{ignoreType:r.astOnly,astAddId:"S7 Add: Blinding Strike"},{ignoreType:r.astOnly,astAddId:"S7 Add: Increased Efficiency"},{ignoreType:r.astOnly,astAddId:"S7 Add: Mind Merge"},{ignoreType:r.astOnly,astAddId:"S8 Add: HP Up"},{ignoreType:r.astOnly,astAddId:"S8 Add: PP Up"},{ignoreType:r.astOnly,astAddId:"S8 Add: Untouchable Gulper"},{ignoreType:r.astOnly,astAddId:"S8 Add: High-Minded"},{ignoreType:r.dupCodeInSim,astCode:"LB91",simCode:"LB1V"},{ignoreType:r.dupCodeInSim,astCode:"LC88",simCode:"LC1I"},{ignoreType:r.dupCodeInSim,astCode:"LC89",simCode:"LC1H"},{ignoreType:r.dupCodeInSim,astCode:"LC90",simCode:"LC1J"},{ignoreType:r.dupCodeInSim,astCode:"LC91",simCode:"LC1K"}],p='Thank you for updating the Affixing Assistant Database!\nThe Update Manager will guide you through any update that needs to be made based on the latest version of the Affixing Simulator.\nNote that the Update Manager does NOT check for latest common Add Abilities nor common Ability Factors (only checks for SSAs). If any update was performed recently, please take some time to perform the following actions:\n - Make sure that code changes were NOT performed on the "code" property of ANY item in the Assistant. Doing so will break backwards compatibility for the changed item. If the code for any item used in the Affixing Simulator has changed, please include or change the "simCode" property of the respective item instead.\n - Make sure to ONLY propose changes to Update Manager\'s ignoreList for cases the manager outputs a correction that you are absolutely certain has been resolved. In such cases where you cannot build because of a false-negative in the validation process, describe the scenario and the reason for the change in the ignoreList in a new Issue on GitHub.\n - Check out the latest information at pso2.swiki.jp to make sure the update matches the information there (such as new Add Abilities, new Ability Factors, new Potentials, new Support Items, etc.).\n - Finally, make sure to test the updated Affixing Assistant in debug mode and production mode. Try to focus on the new abilities, but test other parts as well according to your discretion.';function u(e){if(void 0===e||null===e||"function"!=typeof e)return console.warn("WARN Illegal Argument passed to fetchUpdates"),console.warn(" - Usage: fetchUpdates(completion)"),void console.warn("   - completion: the completion handler function containing one parameter for the data retrieved");let t=null;console.log("Obtaining latest PSO2 Affixing Assistant data..."),i("https://arks-layer.com/abilitysim/params.min.json").then(e=>e.json()).then(n=>{t=n,httpsAgent=new https.Agent({rejectUnauthorized:!1}),console.log("Obtaining latest PSO2 Swiki data..."),i("https://pso2.swiki.jp/index.php?S%E7%B4%9A%E7%89%B9%E6%AE%8A%E8%83%BD%E5%8A%9B",{method:"GET",agent:httpsAgent}).then(e=>e.text()).then(n=>{const i=o.load(n);i?e(t,i):e(null,null)}).catch(t=>{console.log("Failed to obtain the latest PSO2 Swiki data..."),console.error(t),e(null,null)})}).catch(t=>{console.log("Failed to obtain the latest PSO2 Affixing Assistant data..."),console.error(t),e(null,null)})}function f(n){a.parser.parse(s.data);e.existsSync(d)||e.mkdirSync(d),e.writeFile("intermediate/affixingassistant.min.temp.txt","/** PSO2 Affixing Assistant\n * @author malulleybovo (since 2018)\n * @license GNU General Public License v3.0\n *\n * @licstart  The following is the entire license notice for the \n *  JavaScript code in this page.\n *\n * Copyright (C) 2018  Arthur Malulley B. de O.\n *\n *\n * The JavaScript code in this page is free software: you can\n * redistribute it and/or modify it under the terms of the GNU\n * General Public License (GNU GPL) as published by the Free Software\n * Foundation, either version 3 of the License, or (at your option)\n * any later version.  The code is distributed WITHOUT ANY WARRANTY;\n * without even the implied warranty of MERCHANTABILITY or FITNESS\n * FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.\n *\n * As additional permission under GNU GPL version 3 section 7, you\n * may distribute non-source (e.g., minimized or compacted) forms of\n * that code without the copy of the GNU GPL normally required by\n * section 4, provided you include this license notice and a URL\n * through which recipients can access the Corresponding Source.\n *\n * @licend  The above is the entire license notice\n * for the JavaScript code in this page.\n *\n */\n",function(e){if(e)return console.log(stderr),void n("Could not include license.",stdout,stderr);let i="uglifyjs --compress --mangle --toplevel -o %outfolder%/affixingassistant.min.js -- %jssrc% & uglifycss %csssrc% > %outfolder%/stylesheet.min.css & type intermediate\\affixingassistant.min.temp.txt > intermediate\\stylesheet.min.temp.txt & type dist\\affixingassistant.min.js >> intermediate\\affixingassistant.min.temp.txt & type intermediate\\affixingassistant.min.temp.txt > dist\\affixingassistant.min.js & del intermediate\\affixingassistant.min.temp.txt & type dist\\stylesheet.min.css >> intermediate\\stylesheet.min.temp.txt & type intermediate\\stylesheet.min.temp.txt > dist\\stylesheet.min.css & del intermediate\\stylesheet.min.temp.txt";i=(i=(i=i.replace(/%outfolder%/g,"dist")).replace(/%jssrc%/g,"js/gaData.js js/lang.js js/templates.js js/viewcontroller.js js/affixData.js js/affixDataParser.js js/affixingassistant.js js/formulaEncoder.js js/app.js")).replace(/%csssrc%/g,"css/themes.css css/stylesheet.css css/checkbox.css css/radiobutton.css css/dropdown.css css/filtersearch.css"),t(i,(e,t,i)=>{console.log(t),console.log(i),n(e,t,i)})})}function g(e,t,n,i){let o=!0;if(void 0!==i&&(o=!1),i=i||[],(n=n||0)<=t&&void 0!==e&&"object"==typeof e)for(var s in o||i.push(e),n++,e)e.hasOwnProperty(s)&&g(e[s],t,n,i);return i}